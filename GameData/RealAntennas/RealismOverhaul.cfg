@PART[*]:HAS[@MODULE[ModuleRealAntenna]]:AFTER[zRealAntennas]:NEEDS[RealismOverhaul]
{
    @MODULE[ModuleRealAntenna]:HAS[#antennaDiameter[*],#RFBand[L]],*
    {
        %RFBand = S
    }
}

@PART[*]:HAS[@MODULE[ModuleRealAntenna]]:AFTER[zRealAntennas]:NEEDS[RealismOverhaul]
{
    @MODULE[ModuleRealAntenna]:HAS[#RFBand[L]],*
    {
        %RFBand = UHF
    }
}

@PART[*]:HAS[@MODULE[ModuleCommand],@MODULE[ModuleRealAntenna]]:AFTER[zRealAntennas]:NEEDS[RealismOverhaul]
{
    @MODULE[ModuleRealAntenna]
    {
        %RFBand = UHF
    }
}

@RealAntennasCommNetParams:NEEDS[RealismOverhaul]
{
    %minRelayTL = 2
    @TargetingMode[Vessel] { %techLevel = 2 }
    @TargetingMode[BodyCenter] { %techLevel = 0 }
    @TargetingMode[BodyLatLonAlt] { %techLevel = 4 }
    @TargetingMode[AzEl] { %techLevel = 0 }
    @TargetingMode[OrbitRelative] { %techLevel = 2 }

    !BandInfo,* {}
    BandInfo
    {
        name = VHF
        TechLevel = 0
        Frequency = 150e6
        ChannelWidth = 12.5e3
    }
    BandInfo
    {
        name = UHF
        TechLevel = 0
        Frequency = 430e6
        ChannelWidth = 31.5e3
    }
    BandInfo
    {
        name = S
        TechLevel = 3
        Frequency = 2.25e9
        ChannelWidth = 0.330e6
    }
    BandInfo
    {
        name = X
        TechLevel = 7
        Frequency = 8.45e9
        ChannelWidth = 1.36e6
    }
    BandInfo
    {
        name = Ku
        TechLevel = 8
        Frequency = 14.3e9
        ChannelWidth = 20e6
    }
    BandInfo
    {
        name = Ka
        TechLevel = 9
        Frequency = 32.0e9
        ChannelWidth = 20e6
    }
}

@RealAntennasCommNetParams:NEEDS[RealismOverhaul]
{
    !EncoderInfo,* {}
    EncoderInfo
    {
        name = Analog FSK
        TechLevel = 0
        CodingRate = 0.001
        RequiredEbN0 = 10
    }
    EncoderInfo
    {
        name = None
        TechLevel = 2
        CodingRate = 1
        RequiredEbN0 = 10
    }
//    EncoderInfo
//    {
//        name = Reed-Muller 32/6/16 [RM(1,5)]
//        TechLevel = 3
//        CodingRate = 0.25     // s/b 6/32 = 0.1875
//        RequiredEbN0 = 5.5
//    }
// https://www.researchgate.net/figure/Code-rates-of-Reed-Muller-code-RM-1-m-and-corresponding-SIR-requirement-for-target_tbl2_1959018
// +1.4dB to go from BER 1e-3 to 1e-5
    EncoderInfo
    {
        name = Reed-Muller 1,3
        TechLevel = 3
        CodingRate = 0.5
        RequiredEbN0 = 6.5
    }
    EncoderInfo
    {
        name = Reed-Solomon 255/223
        TechLevel = 5
        CodingRate = 0.8745
        RequiredEbN0 = 6.1
    }
    EncoderInfo
    {
        name = Convolutional 7, 1/2
        TechLevel = 6
        CodingRate = 0.5
        RequiredEbN0 = 4.5
    }
//  EncoderInfo
//    {
//        name = Convolutional 7, 7/8
//        reference = http://www.ieee802.org/16/tg1/phy/contrib/802161pc-00_33.pdf
//        TechLevel = 100
//        CodingRate = 0.875
//        RequiredEbN0 = 6.5
//    }
    EncoderInfo
    {
        name = Concatenated Reed-Solomon,Convolutional
        reference = http://www.ieee802.org/16/tg1/phy/contrib/802161pc-00_33.pdf
        TechLevel = 7
        CodingRate = 0.43725
        RequiredEbN0 = 3.3
    }
    EncoderInfo
    {
        name = Turbo 1/2
        TechLevel = 8
        CodingRate = 0.5
        RequiredEbN0 = 1
    }
}

@RealAntennasCommNetParams:NEEDS[RealismOverhaul]
{
    !TechLevelInfo,* {}
    TechLevelInfo
    {
        name = TL0
        Level = 0
        Description = WW2-era
        PowerEfficiency = 0.0555
        ReflectorEfficiency = 0.5
        MinDataRate = 4
        MaxDataRate = 4
        MaxPower = 20
        MassPerWatt = 1.6
        BaseMass = 1
        BasePower = 2
        BaseCost = 2
        CostPerWatt = 5
        ReceiverNoiseTemperature = 27000    // 20dB
    }
    TechLevelInfo
    {
        name = TL1
        Level = 1
        Description = Lunar Range Comms, 1956: 26m antenna 1958
        PowerEfficiency = 0.0769
        ReflectorEfficiency = 0.52
        MinDataRate = 4
        MaxDataRate = 4
        MaxPower = 30
        MassPerWatt = 1.34
        BaseMass = 0.26
        BasePower = 0.3
        BaseCost = 4
        CostPerWatt = 4
        ReceiverNoiseTemperature = 11500    // 16dB
    }
    TechLevelInfo
    {
        name = TL2
        Level = 2
        Description = Digital Comms, 1959-1960
        PowerEfficiency = 0.1
        ReflectorEfficiency = 0.54
        MinDataRate = 1
        MaxDataRate = 64
        MaxPower = 37
        MassPerWatt = 1.16
        BaseMass = 6.9
        BasePower = 8
        BaseCost = 30
        CostPerWatt = 3.5
        ReceiverNoiseTemperature = 7000 // 14dB
    }
    TechLevelInfo
    {
        name = TL3
        Level = 3
        Description = Interplanetary Comms, 1961-1963: Maser 1962, S/C noise reduction 1961 (300-3000K=10dB noise temp)
        PowerEfficiency = 0.1304
        ReflectorEfficiency = 0.56
        MinDataRate = 8
        MaxDataRate = 64
        MaxPower = 37
        MassPerWatt = 1
        BaseMass = 20.2
        BasePower = 19.5
        BaseCost = 50
        CostPerWatt = 3
        ReceiverNoiseTemperature = 5800 // 13dB
    }
    TechLevelInfo
    {
        name = TL4
        Level = 4
        Description = Improved Comms, 1964-1966: 64m Antenna 1967
        PowerEfficiency = 0.1667
        ReflectorEfficiency = 0.58
        MinDataRate = 8
        MaxDataRate = 4096
        MaxPower = 40
        MassPerWatt = 0.86
        BaseMass = 17.2
        BasePower = 25.7
        BaseCost = 80
        CostPerWatt = 2.5
        ReceiverNoiseTemperature = 4500 // 11.7dB
    }
    TechLevelInfo
    {
        name = TL5
        Level = 5
        Description = Advanced Comms, 1967-1971: Noise reduction 1968, block coding 1969
        PowerEfficiency = 0.2222
        ReflectorEfficiency = 0.6
        MinDataRate = 16
        MaxDataRate = 16384
        MaxPower = 43
        MassPerWatt = 0.75
        BaseMass = 21
        BasePower = 23
        BaseCost = 120
        CostPerWatt = 2
        ReceiverNoiseTemperature = 3000 // 10dB     https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19660015650.pdf
    }
    TechLevelInfo
    {
        name = TL6
        Level = 6
        Description = Deep Space Comms, 1971-1974: Antenna improvements 1971-1972, Convolutional coding ~1973
        PowerEfficiency = 0.25
        ReflectorEfficiency = 0.62
        MinDataRate = 16
        MaxDataRate = 131072
        MaxPower = 43
        MassPerWatt = 0.6444
        BaseMass = 30.7
        BasePower = 21.4
        BaseCost = 175
        CostPerWatt = 1.7
        ReceiverNoiseTemperature = 1540 // 7.5dB
    }
    TechLevelInfo
    {
        name = TL7
        Level = 7
        Description = High Data Rate Comms, 1976-1980: X-Band ~1975, concatenated coding, MW noise reduction ~1980
        PowerEfficiency = 0.3
        ReflectorEfficiency = 0.64
        MinDataRate = 16
        MaxDataRate = 262144
        MaxPower = 46
        MassPerWatt = 0.6
        BaseMass = 21.3
        BasePower = 18.3
        BaseCost = 125
        CostPerWatt = 1.2
        ReceiverNoiseTemperature = 1100 // 6.1dB  https://commons.erau.edu/cgi/viewcontent.cgi?referer=https://www.google.com/&httpsredir=1&article=2697&context=space-congress-proceedings
    }
    TechLevelInfo
    {
        name = TL8
        Level = 8
        Description = Massive Scale Comms, 1986-1997: 70m antennas 1988
        PowerEfficiency = 0.3724
        ReflectorEfficiency = 0.66
        MinDataRate = 16
        MaxDataRate = 262144
        MaxPower = 46
        MassPerWatt = 0.54
        BaseMass = 21.3
        BasePower = 18.3
        BaseCost = 75
        CostPerWatt = 0.5
        ReceiverNoiseTemperature = 500  // 2.6dB
    }
    TechLevelInfo
    {
        name = TL9
        Level = 9
        Description = Efficient Comms, 1998-2008: Super-cooled maser & feed 1995, Ka-band 2004
        PowerEfficiency = 0.4397
        ReflectorEfficiency = 0.68
        MinDataRate = 16
        MaxDataRate = 134217728
        MaxPower = 50
        MassPerWatt = 0.1418
        BaseMass = 7.5
        BasePower = 11.7
        BaseCost = 50
        CostPerWatt = 0.4
        ReceiverNoiseTemperature = 200  // 1.8dB
    }
}

@Kopernicus:AFTER[zRealAntennas]:NEEDS[RealismOverhaul]
{
    @Body[Kerbin]
    {
        @PQS
        {
            @Mods
            {
                @City2[*TrackingStation],*
                {
                    !Antenna,* {}                   // Delete and rebuild all antennas
                    %commnetStation = False
                    RACommNetStation = True
                    Antenna
                    {
                        referenceGain = 1           // Everyone gets a weak VHF
                        TxPower = 40                // 10W
                        TechLevel = 0
                        RFBand = VHF
                        AMWTemp = 1340.8            // 7.5dB, https://archive.org/details/nasa_techdoc_19630042971/page/n21
                        ModulationBits = 1          // BPSK only
                    }
                    Antenna
                    {
                        referenceGain = 3           // Everyone gets a weak UHF
                        TxPower = 40                // 10W
                        TechLevel = 0
                        RFBand = UHF
                        AMWTemp = 1340.8
                        ModulationBits = 1          // BPSK only
                    }
                }
                @City2[DSNTrackingStation],*
                {
                    @Antenna:HAS[#RFBand[VHF]],*
                    {
                        @referenceGain = 20         // DSN gets some array
                        %referenceFrequency = 150
                        @TxPower = 50
                    }
                    @Antenna:HAS[#RFBand[UHF]],*
                    {
                        @referenceGain = 20         // DSN gets some array
                        %referenceFrequency = 430
                        @TxPower = 50

                        UPGRADE
                        {
                            TechLevel = 1           // https://archive.org/details/nasa_techdoc_19630042971/page/n21
                            referenceGain = 34      // GoldStone upgrades for Pioneer-3/4
                        }
                    }
                    Antenna
                    {
                        referenceGain = 49          // Original S-Band 18m, -3dBi vs 26m (module 102)
                        referenceFrequency = 2250
                        TxPower = 63                // 2KW
                        TechLevel = 0
                        RFBand = S
                        AMWTemp = 290
                        ModulationBits = 1

                        UPGRADE
                        {
                            TechLevel = 1           // "Lunar Range Comms" 1957-1958 tech node
                            referenceGain = 52.5    // 26m antenna 1958
                        }
                        UPGRADE
                        {
                            TechLevel = 2           // Digital Comms, 1959-1960, Encoder Available
                        }
                        UPGRADE
                        {
                            TechLevel = 3           // "Interplanetary Comms" 1961-1963 tech node
                            AMWTemp = 125           // Reduced spacecraft noise 1961 (S/C should still be 3000K = 10dB !), Maser 1962
                        }
                        UPGRADE
                        {
                            TechLevel = 4           // "Improved Comms" 1964-1966 tech node
                            referenceGain = 60.5    // 64m Antenna: +8dB?  1967
                        }
                        UPGRADE
                        {
                            TechLevel = 5           // "Advanced Comms" 1967-1971 tech node (1967-1970)
                            AMWTemp = 80            // Noise reduction 1968, block coding 1969
                        }
                        UPGRADE
                        {
                            TechLevel = 6           // "Deep Space Comms" 1972-1975 tech node  (1971-1974)
                            referenceGain = 62.5    // Antenna improvements 1971-1972, Convolutional coding ~1973
                        }
                        UPGRADE
                        {
                            TechLevel = 7           // "High Data Rate Comms" 1976-1980 tech node
                            AMWTemp = 40            // X-Band introduction ~1975, concatenated coding
                            ModulationBits = 2      // MW noise reduction ~1980
                        }
                        UPGRADE
                        {
                            TechLevel = 8           // "Massive Scale Comms" 1986-1997 tech node
                            referenceGain = 63.6    // 70m antennas +.8dBi 1988
                            TxPower = 73            // 20KW
                        }
                        UPGRADE
                        {
                            TechLevel = 9           // "Efficient Comms" 1998-2008 tech node
                            AMWTemp = 17.6          // Super-cooled maser & feed 1995, Ka-band 2004
                        }
                    }
                    Antenna
                    {
                        referenceGain = 73.5        // X-Band 64m
                        referenceFrequency = 8450
                        TxPower = 70                // 10KW
                        TechLevel = 7
                        RFBand = X
                        AMWTemp = 40
                        ModulationBits = 2

                        UPGRADE
                        {
                            TechLevel = 8
                            referenceGain = 74.3
                            TxPower = 73
                        }
                        UPGRADE
                        {
                            TechLevel = 9
                            AMWTemp = 12.8
                        }
                    }
                    Antenna
                    {
                        referenceGain = 79          // Ka-Band 34m
                        referenceFrequency = 32000
                        TxPower = 54.8
                        TechLevel = 9
                        RFBand = Ka
                        AMWTemp = 20
                        ModulationBits = 2
                    }
                }
                //NEN/STDN stations
                //sources:
                // [1] https://ntrs.nasa.gov/api/citations/20205005784/downloads/453NENUGRev5__clean_final_82420.pdf
                // [2] https://web.archive.org/web/20100517062101/http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19750071915_1975071915.pdf
                // [3] https://web.archive.org/web/20100523080751/http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19670008308_1967008308.pdf
                // [4] https://www.hmdb.org/m.asp?m=13923
                // [5] https://web.archive.org/web/20210420204240/https://science.ksc.nasa.gov/facilities/mila/milstor.html
                // [6] http://imbrium.mit.edu/LRORS/DOCUMENT/453_HDBK_GN.PDF
                // [7] https://sky-brokers.com/wp-content/uploads/2020/12/Datasheet-Vertex-6.1m-Cassegrain-KXK-Ku-band-Earth-Station-Antenna.pdf
                // [8] https://www.ospo.noaa.gov/Operations/WCDAS/
                // [9] https://digitalcommons.usu.edu/cgi/viewcontent.cgi?referer=&httpsredir=1&filename=0&article=3808&context=smallsat&type=additional
                // [10] https://explorers.larc.nasa.gov/2023ESE/pdf_files/LEGS%20Brochure%20r20.pdf
                // [11] https://amrc.ssec.wisc.edu/meetings/MGS/history.html#:~:text=The%20McMurdo%20Ground%20Station%20(MGS,and%20Space%20Administration%20(NASA)
                // [12] https://core.ac.uk/download/pdf/10553337.pdf
                // [13] https://tempo.gsfc.nasa.gov/news/New_System_Giving_SMAP_Scientists_the_Speed_They_Need
                
                //Cape Canaveral (MILA/PDL/KUS)
                //MILA, Ponce deLeon and KUS are close enough together that I'm just gonna consider them one station
                @City2[CanaveralTrackingStation]
                {
                    //SATAN (1964-1979)
                    @Antenna:HAS[#RFBand[VHF]],*
                    {
                        // SATAN VHF system. Installed at Ft. Myers, but relocated to the cape 1972?
                        // Reciever temp not listed in VHF band due to "high variance". Assume same as generic stations
                        UPGRADE
                        {
                            TechLevel = 4               // [3] SATAN antennas installed between 1964-1966?
                            referenceGain = 21          // [2]
                            referenceFrequency = 136    // [2]
                            TxPower = 64                // [2] 2.5-5.0 kW output available to VHF
                        }
                        //Decommissioned 1979-1980, but taking station away seems mean [5]
                    }
                    //TELTRAC (Also AGAVE?) 18-element (1966-2011) [5/6]
                    @Antenna:HAS[#RFBand[UHF]],*
                    {
                        // Teltrac UHF system.
                        // Reciever temp not listed in UHF band due to "high variance". Assume same as generic stations
                        // Command antenna transmit power not listed. Assume same as generic stations (10 W)
                        UPGRADE
                        {
                            TechLevel = 4               // [3] TELTRAC antennas installed 1966?
                            referenceGain = 19          // [2]
                            referenceFrequency = 225    // [2]
                            TxPower = 64                // [2] 2.5-5.0 kW output?
                        }
                        //More modern system installed for shuttle voice backup 1992?
                        //Decommissioned 2011, but taking station away seems mean [5]
                    }
                    //9m USB (uncooled) (1966)
                    Antenna
                    {
                        referenceGain = 44          // [2]
                        referenceFrequency = 2250   // [2]
                        TxPower = 73                // [2] 20 kW available to USB transmitter
                        TechLevel = 5               // [2] 1966? Didn't recieve command capability until later...
                        RFBand = S                  //
                        AMWTemp = 170               // [1]
                        ModulationBits = 1          // [1]

                        UPGRADE
                        {
                            TechLevel = 7               // Upgraded late 70s for shuttle?
                            ModulationBits = 2          // [1] QPSK capable
                        }
                        //Kennedy Uplink Station/refurbished Ponce deLeon Station (2019)
                        UPGRADE
                        {
                            TechLevel = 9               // KUS came online 2019
                            referenceGain = 40.8        // [1] 6.1 m antenna
                            referenceFrequency = 2200   // [1]
                            TxPower = 47                // [1] 57 dBW EIRP. EIRP = G(dBi) + P(dBW)
                            AMWTemp = 106               // [1] G/T 17.2, G/T = G - 10log(T). Worst case scenario at horizion (which RA already simulates?). Decrease by 0.54 based on [7] to simulate 20 degrees?
                        }
                    }
                    //X and Ku-band antennas installed at MILA, but only for testing purposes?
                }
                
                //GSFC Wallops tracking station
                //Originally located in Greenbelt, relocated to Wallops?
                @City2[*TrackingStation]:HAS[#objectName[US?-?Wallops]]
                {
                    @name = WallopsTrackingStation
                    //Tracking systems of some description existed here since the early 50s, but I can't find any information on them

                    @Antenna:HAS[#RFBand[VHF]],*
                    {
                        // 12m TLM multiband. Began construction 1965, online 1967ish?
                        // Reciever temp not listed in VHF band due to "high variance". Assume same as generic stations
                        UPGRADE
                        {
                            TechLevel = 5               // [7] Facility began construction 1965?
                            referenceGain = 16          // [2]
                            referenceFrequency = 136    // [2]
                            TxPower = 64                // [2] 2.5-5.0 kW output available to VHF
                        }
                        UPGRADE
                        {
                            TechLevel = 9               // [1] Built to support ISS
                            referenceGain = 18          // [1]
                            referenceFrequency = 139    // [1]
                            TxPower = 55                // [1]
                        }
                    }

                    @Antenna:HAS[#RFBand[UHF]],*
                    {
                        // 12m TLM multiband. Began construction 1965, online 1967ish?
                        UPGRADE
                        {
                            TechLevel = 5               // [7] Facility began construction 1965?
                            referenceGain = 30.6        // [2]
                            referenceFrequency = 400    // [2]
                            TxPower = 70                // [2] 10 kW output available to UHF
                            AMWTemp = 600               // [2]
                        }
                        //Decommissioned(?), but taking station away seems mean
                    }

                    Antenna
                    {
                        // 12m TLM multiband. Began construction 1965, online 1967ish?
                        referenceGain = 46          // [2]
                        referenceFrequency = 2250   // [2]
                        TxPower = 73                // [2] 20 kW available to USB transmitter
                        TechLevel = 5               // [2] Facility began construction 1965?
                        RFBand = S                  //
                        AMWTemp = 200               // [2]
                        ModulationBits = 1          //
                        
                        UPGRADE
                        {
                            //WG1 11.28m antenna
                            TechLevel = 8               // added in the 80s I guess?
                            referenceGain = 45.8        // [1]
                            referenceFrequency = 2200   // [1]
                            TxPower = 51                // [1]
                            AMWTemp = 123               // [1]
                            ModulationBits = 2          // [1]
                        }
                    }
                    
                    Antenna
                    {
                        //WG1 11.28m antenna
                        //This antenna can't actually transmit in X-band, but according to [8] Wallops has other high-gain antennas that can.
                        referenceGain = 56.8        // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 51                // guess
                        TechLevel = 8               // added in the 80s I guess?
                        RFBand = X                  //
                        AMWTemp = 170               // [1]
                        ModulationBits = 2          //
                        
                        UPGRADE
                        {
                            TechLevel = 9               //encoder upgrade in 2000s?
                            ModulationBits = 6          // [1]
                        }
                    }
                    //Ka/Ku-band TDRSS terminal added around 2012? Can't find information.
                }
                
                //White Sands Ground Station
                //Construction started 1976 to serve as primary TDRSS ground terminal. Limited commercial capability also offered to NEN using excess capacity
                @City2[*TrackingStation]:HAS[#objectName[US?-?White?Sands]]
                {
                    @name = WhiteSandsTrackingStation
                    
                    Antenna
                    {
                        //WS1 18.3 meter antenna, S-Band
                        referenceGain = 50          // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 63                // [1] 2 kW
                        TechLevel = 7               // [2] Installed in late 70s to support TDRSS
                        RFBand = S                  //
                        AMWTemp = 110               // [1]
                        ModulationBits = 2          // [1]
                    }
                    Antenna
                    {
                        //WS1 18.3 meter antenna, X-band
                        referenceGain = 62          // estimated
                        referenceFrequency = 8000   // [10]
                        TxPower = 54                // [10]
                        TechLevel = 7               // [2] Installed in late 70s to support TDRSS
                        RFBand = X                  //
                        AMWTemp = 200               // [10]
                        ModulationBits = 2          // [10]
                    }
                    Antenna
                    {
                        //WS1 18.3 meter antenna, Ku-band
                        //Not much information available on Ku-band, but Gen1 TDRS used Ku-band as downlink channel at 14.5 GHz
                        referenceGain = 66          // estimated
                        referenceFrequency = 14500  // 
                        TxPower = 54                // 
                        TechLevel = 8               // [2] Installed in late 70s to support TDRSS
                        RFBand = Ku                 //
                        AMWTemp = 282               //
                        ModulationBits = 2          //
                        
                        UPGRADE
                        {
                            TechLevel = 9           // encoder upgrades 2017?
                            ModulationBits = 3      // [1] MTRSU can link to White Sands at 8PSK, so I guess White Sands was upgraded too
                        }
                    }
                    Antenna
                    {
                        //WS1 18.3 meter antenna, Ka-band
                        referenceGain = 70.5        // [1]
                        referenceFrequency = 25500  // [1]
                        TxPower = 49                // [10]
                        TechLevel = 9               //
                        RFBand = Ka                 //
                        AMWTemp = 282               // [10]
                        ModulationBits = 2          // [10]
                    }
                }
                
                //McMurdo Ground Station
                //Became active 1995
                //Also including Ku-band TDRSS uplink antenna
                //Uses Ku-band downlink channel to create high-speed link with White Sands via TDRSS
                @City2[MGSTrackingStation]
                {
                    Antenna
                    {
                        //MG1 10 meter antenna, S-Band
                        referenceGain = 45          // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 49                // [1]
                        TechLevel = 8               // [11]
                        RFBand = S                  //
                        AMWTemp = 251               // [1]
                        ModulationBits = 1          // [11]
                        
                        UPGRADE
                        {
                            TechLevel = 9               //encoder upgrade in 2000s?
                            ModulationBits = 2          // [1]
                        }
                    }
                    Antenna
                    {
                        //MG1 10 meter antenna, X-Band
                        referenceGain = 56          // [1]
                        referenceFrequency = 7700   // [1]
                        TxPower = 49                // [1]
                        TechLevel = 8               // [11]
                        RFBand = X                  //
                        AMWTemp = 251               // [1]
                        ModulationBits = 2          // [11]
                        
                        UPGRADE
                        {
                            TechLevel = 9               //encoder upgrade in 2000s?
                            ModulationBits = 6          // [1]
                        }
                    }
                    Antenna
                    {
                        //MTRSU 4.5 meter(?) antenna, Ku-Band
                        //Installed 1996?
                        referenceGain = 54          // estimated
                        referenceFrequency = 14500  //
                        TxPower = 35                // [12]
                        TechLevel = 8               // [11]
                        RFBand = Ku                 // [1]
                        AMWTemp = 251               //
                        ModulationBits = 2          //
                        
                        UPGRADE
                        {
                            TechLevel = 9               // encoder upgrade in 2017?
                            ModulationBits = 3          // [1]
                        }
                    }
                }
                
                //Alaska Satellite Facility (ASF)
                //ALso including Gilmore, Fairbanks, University, SSC North Pole, and other stations installed in Fairbanks
                //Original radio telescopes installed 1962, command capability added later
                @City2[ASFTrackingStation]
                {
                    //SATAN (1964-1979)
                    @Antenna:HAS[#RFBand[VHF]],*
                    {
                        // SATAN VHF system. Installed at Ft. Myers, but relocated to the cape 1972?
                        // Reciever temp not listed in VHF band due to "high variance". Assume same as generic stations
                        UPGRADE
                        {
                            TechLevel = 4               // [3] SATAN antennas installed between 1964-1966?
                            referenceGain = 21          // [2]
                            referenceFrequency = 136    // [2]
                            TxPower = 64                // [2] 2.5-5.0 kW output available to VHF
                        }
                        //Decommissioned 1979-1980, but taking station away seems mean [5]
                    }
                    //9m USB (cooled?) (1975?)
                    Antenna
                    {
                        referenceGain = 44          // [2]
                        referenceFrequency = 2250   // [2]
                        TxPower = 73                // [2] 20 kW available to USB transmitter
                        TechLevel = 7               // [2] 1966? Didn't recieve command capability until 1970s
                        RFBand = S                  //
                        AMWTemp = 95                // [2]
                        ModulationBits = 2          // [1]

                        //Alaska Satellite Facility AS1 comes online 1991
                        UPGRADE
                        {
                            TechLevel = 8               //
                            referenceGain = 45.8        // [1] 
                            referenceFrequency = 2200   // [1]
                            TxPower = 49                // [1] 64 dBW EIRP. EIRP = G(dBi) + P(dBW)
                            AMWTemp = 129               // [1] G/T 22, G/T = G - 10log(T). Worst case scenario at horizion (which RA already simulates?). Decrease by 0.54 based on [7] to simulate 20 degrees?
                        }
                    }
                    //Alaska Satellite Facility AS1 comes online 1991
                    Antenna
                    {
                        referenceGain = 56.8        // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 49                // can't actually transmit in X-band, just say same as S-band
                        TechLevel = 8               // [1]
                        RFBand = X                  //
                        AMWTemp = 91                // [1]
                        ModulationBits = 2          // 

                        //encoder upgrades in 2000s?
                        UPGRADE
                        {
                            TechLevel = 9               //
                            ModulationBits = 6          // [1]
                        }
                    }
                }
                
                //KSAT Singapore
                //Can't find much info on this. Established 2002ish?
                @City2[SingaporeTrackingStation]
                {
                    //SI1 9.1 meter antenna
                    Antenna
                    {
                        referenceGain = 43.13       // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 45                // [1]
                        TechLevel = 9               // [1]
                        RFBand = S                  //
                        AMWTemp = 183               // [1]
                        ModulationBits = 2          // [1]
                    }
                    //SI1 9.1 meter antenna
                    Antenna
                    {
                        referenceGain = 55.42       // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 45                // can't actually transmit in X-band, just say same as S-band
                        TechLevel = 9               // [1]
                        RFBand = X                  //
                        AMWTemp = 100               // [1]
                        ModulationBits = 2          // [1]
                    }
                }
                
                //KSAT Svalbard
                //Established 1997
                @City2[*TrackingStation]:HAS[#objectName[KSAT?-?Svalbard]]
                {
                    @name = SvalbardTrackingStation
                    
                    //SG3 13 meter antenna
                    Antenna
                    {
                        referenceGain = 46.9        // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 51                // [1]
                        TechLevel = 8               // [1]
                        RFBand = S                  //
                        AMWTemp = 245               // [1]
                        ModulationBits = 2          // [1]
                    }
                    //SG3 13 meter antenna
                    Antenna
                    {
                        referenceGain = 59          // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 51                // can't actually transmit in X-band, just say same as S-band
                        TechLevel = 8               // [1]
                        RFBand = X                  //
                        AMWTemp = 132               // [1]
                        ModulationBits = 2          // [1]
                    }
                }
                
                //KSAT Troll Station
                //Established 2007
                @City2[*TrackingStation]:HAS[#objectName[KSAT?-?Troll?Station]]
                {
                    @name = TrollsatTrackingStation
                    
                    //TR2 13 meter antenna
                    Antenna
                    {
                        referenceGain = 41.8        // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 40                // [1]
                        TechLevel = 9               // [1]
                        RFBand = S                  //
                        AMWTemp = 174               // [1]
                        ModulationBits = 2          // [1]
                    }
                    //TR2 13 meter antenna
                    Antenna
                    {
                        referenceGain = 54          // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 40                // can't actually transmit in X-band, just say same as S-band
                        TechLevel = 9               // [1]
                        RFBand = X                  //
                        AMWTemp = 158               // [1]
                        ModulationBits = 2          // [1]
                    }
                }
                
                //SANSA Hartebeesthoek/Johannesburg
                //Originally created 1956, moved to current location 1960
                //Radio telescope, didn't recieve command capability until later (2000s?)
                @City2[*TrackingStation]:HAS[#objectName[STDN?-?Johannesburg]]
                {
                    @name = HartebeesthoekTrackingStation
                    
                    //HBK01 12 meter antenna
                    Antenna
                    {
                        referenceGain = 46          // [2]
                        referenceFrequency = 2200   // [1]
                        TxPower = 53                // [1]
                        TechLevel = 9               // [1]
                        RFBand = S                  //
                        AMWTemp = 229               // [1]
                        ModulationBits = 2          //
                    }
                }
                
                //SSC Kiruna/Esrange Station
                //Established 1978
                @City2[*TrackingStation]:HAS[#objectName[SE?-?Esrange]]
                {
                    @name = EsrangeTrackingStation
                    
                    //KU1S 13 meter antenna
                    Antenna
                    {
                        referenceGain = 46.5        // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 53                // [1]
                        TechLevel = 7               // [1]
                        RFBand = S                  //
                        AMWTemp = 251               // [1]
                        ModulationBits = 2          // [1]
                    }
                    //KU1S 13 meter antenna
                    Antenna
                    {
                        referenceGain = 60          // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 53                // can't actually transmit in X-band, just say same as S-band
                        TechLevel = 7               // [1]
                        RFBand = X                  //
                        AMWTemp = 178               // [1]
                        ModulationBits = 2          //
                        
                        //encoder upgrades in 2000s?
                        UPGRADE
                        {
                            TechLevel = 9               //
                            ModulationBits = 3          // [1]
                        }
                    }
                }
                
                //SSC Santiago Station
                //Established 1958
                @City2[SantiagoTrackingStation]
                {
                    //9m USB antenna (1966?)
                    Antenna
                    {
                        referenceGain = 44          // [2]
                        referenceFrequency = 2250   // [2]
                        TxPower = 73                // [2] 20 kW available to USB transmitter
                        TechLevel = 5               // [2] 1966? Didn't recieve command capability until later...
                        RFBand = S                  //
                        AMWTemp = 170               // [2]
                        ModulationBits = 1          // [2]
                        
                        UPGRADE
                        {
                            TechLevel = 7               // Upgraded late 70s?
                            ModulationBits = 2          // [1] QPSK capable
                        }
                        
                        //SA3 13-meter Antenna online 2011
                        UPGRADE
                        {
                            referenceGain = 47          // [1]
                            referenceFrequency = 2200   // [1]
                            TxPower = 54                // [1]
                            TechLevel = 9               //
                            AMWTemp = 182               // [1]
                        }
                    }
                }
                
                //SSC Dongara Station
                //Established 2007
                @City2[DongaraTrackingStation]
                {
                    //AUWA01 13-meter antenna
                    Antenna
                    {
                        referenceGain = 48          // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 51                // [1]
                        TechLevel = 9               //
                        RFBand = S                  //
                        AMWTemp = 281               // [1]
                        ModulationBits = 2          // [1]
                    }
                }
                
                //SSC Souht Point Station
                //Established 2007
                @City2[SouthPointTrackingStation]
                {
                    //USHI02 13-meter antenna
                    Antenna
                    {
                        referenceGain = 48          // [1]
                        referenceFrequency = 2200   // [1]
                        TxPower = 51                // [1]
                        TechLevel = 9               //
                        RFBand = S                  //
                        AMWTemp = 282               // [1]
                        ModulationBits = 2          // [1]
                    }
                    //USHI02 13-meter antenna
                    Antenna
                    {
                        referenceGain = 59.1        // [1]
                        referenceFrequency = 8000   // [1]
                        TxPower = 59                // [1]
                        TechLevel = 9               //
                        RFBand = X                  //
                        AMWTemp = 138               // [1]
                        ModulationBits = 2          // [1]
                    }
                }
            }
        }
    }
}